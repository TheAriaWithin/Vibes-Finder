<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Runestomper Vibes Finder</title>
  <style>
    body { font-family: sans-serif; background: #111; color: #fff; margin: 0; padding: 20px; }
    .chat-box { max-width: 600px; margin: auto; background: #222; padding: 20px; border-radius: 10px; height: 400px; overflow-y: auto; }
    .message { margin-bottom: 10px; }
    .user { text-align: right; color: #8f8; }
    .bot { text-align: left; color: #8ff; }
    input { width: 100%; padding: 10px; border: none; border-radius: 5px; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="chat-box" id="chat-box">
    <div class="message bot">Welcome! Tell me how you're feeling today and Iâ€™ll match you with a Runestomper song.</div>
  </div>
  <input type="text" id="user-input" placeholder="Type your mood..." />

  <script>
    const chatBox = document.getElementById('chat-box');
    const userInput = document.getElementById('user-input');
    const backendURL = '/api/chat';

    function append(sender, text) {
      const div = document.createElement('div');
      div.className = 'message ' + sender;
      div.textContent = text;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    userInput.addEventListener('keypress', async e => {
      if (e.key === 'Enter' && userInput.value.trim()) {
        append('user', userInput.value);
        const msg = userInput.value;
        userInput.value = '';
        try {
          const res = await fetch(backendURL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ message: msg })
          });
          const json = await res.json();
          append('bot', json.reply);
        } catch (err) {
          append('bot', 'Oops! Something went wrong.');
          console.error(err);
        }
      }
    });
  </script>
</body>
</html>
